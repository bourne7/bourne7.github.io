# 最大公约数算法

2019-02-02

> [http://blog.jobbole.com/106315/](http://blog.jobbole.com/106315/)

## 辗转相除法

又名欧几里得算法（Euclidean algorithm），目的是求出两个正整数的最大公约数。它是已知最古老的算法， 其可追溯至公元前300年前。

这条算法基于一个定理：两个正整数a和b（a&gt;b），它们的最大公约数等于a除以b的余数c和b之间的最大公约数。比如10和25，25除以10商2余5，那么10和25的最大公约数，等同于10和5的最大公约数。

我们可以使用递归的方法来把问题逐步简化。

## 更相减损术

出自于中国古代的《九章算术》，也是一种求最大公约数的算法。

他的原理更加简单：两个正整数a和b（a&gt;b），它们的最大公约数等于a-b的差值c和较小数b的最大公约数。比如10和25，25减去10的差是15,那么10和25的最大公约数，等同于10和15的最大公约数。

## 奇偶判断

众所周知，移位运算的性能非常快。对于给定的正整数a和b，不难得到如下的结论。其中gcb\(a,b\)的意思是a,b的最大公约数函数：

```text
当a和b均为偶数，gcb(a,b) = 2*gcb(a/2, b/2) = 2*gcb(a>>1, b>>1)
当a为偶数，b为奇数，gcb(a,b) = gcb(a/2, b) = gcb(a>>1, b)
当a为奇数，b为偶数，gcb(a,b) = gcb(a, b/2) = gcb(a, b>>1)
当a和b均为奇数，利用更相减损术运算一次，gcb(a,b) = gcb(b, a-b)， 此时a-b必然是偶数，又可以继续进行移位运算。
```

比如计算10和25的最大公约数的步骤如下：

整数10通过移位，可以转换成求5和25的最大公约数 利用更相减损法，计算出25-5=20，转换成求5和20的最大公约数 整数20通过移位，可以转换成求5和10的最大公约数 整数10通过移位，可以转换成求5和5的最大公约数 利用更相减损法，因为两数相等，所以最大公约数是5 在两数比较小的时候，暂时看不出计算次数的优势，当两数越大，计算次数的节省就越明显。

最后总结一下上述所有解法的时间复杂度：

1.暴力枚举法：时间复杂度是O\(min\(a, b\)\)\)

2.辗转相除法：时间复杂度不太好计算，可以近似为O\(log\(min\(a, b\)\)\)，但是取模运算性能较差。

3.更相减损术：避免了取模运算，但是算法性能不稳定，最坏时间复杂度为O\(max\(a, b\)\)\)

4.更相减损术与移位结合：不但避免了取模运算，而且算法性能稳定，时间复杂度为O\(log\(max\(a, b\)\)\)

> 原作者：玻璃猫

